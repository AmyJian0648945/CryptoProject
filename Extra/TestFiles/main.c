#include <stdint.h>
#include <string.h>
#include <stdio.h>

#include "../Header/modFunctions32.h"
#include "../Header/additionalFunctions32.h"

int main(void){

	uint32_t prime1minus1[16] = {0xf93339f8, 0xe260fe12, 0x08b82fd8, 0x2d674d41, 0xe9b22c7e, 0x4d968c25, 0x19569f0d, 0x05491782, 0x75c2a248, 0xb0fd31ec, 0x18c95495, 0x21c7dc24, 0x3d09a54b, 0xad58814d, 0xc6936729, 0xbdc16136};
	
	uint32_t prime2minus1[16] = {0xef2e21cc, 0x606ec690, 0xd9a86219, 0x5ee30e19, 0x604cb4a2, 0xcbe9bbca, 0x20b606ff, 0x0c510400, 0x80523568, 0x4fe9997a, 0x565023ed, 0x0bd30f6e, 0xcfe34c2f, 0x514e1caa, 0xd597f672, 0x85d1e1c2};

	uint32_t publicExponentB[1] = {0x10001};
	uint32_t privateExponentB[32] = { 0x4a18c038, 0x32aefc22, 0x6139f6c7, 0x15f753a7, 0xfd0e7916, 0x939b9ff, 0xa252060, 0x631341c7, 0x80943f17, 0xf24cf3f4, 0x63f3dc59, 0x80c3cebb, 0x94d0dd6f, 0xce1e2dcd, 0x633f5d82, 0xb4745a5, 0x5b6da35c, 0x72bb3775, 0x8c2cc4d, 0x36d3574c, 0xd9f614d8, 0x57fc3ae5, 0x403e7746, 0x2c2c55bd, 0xb5ffec2d, 0xd04794d6, 0x42cb721d, 0xc2db1258, 0xcbebb445, 0x956fc862, 0xb1ae6760, 0x476f3b8d};
	uint32_t modulusB[32] = { 0xe8d3bb3a, 0x533b8d2e, 0x40c9648c, 0xb80ad232, 0x7482d192, 0xd05640a5, 0x39f756b, 0x807191ef, 0x8210aa05, 0xc931f23e, 0xb8237380, 0xdabd61ed, 0x5cc8fa7f, 0x46c8c72d, 0x96221b4a, 0x4df4d78c, 0x302bd427, 0xd2a2873b, 0x7417bfb6, 0xb20a3d1d, 0x9d787d06, 0xfd98d0bc, 0x18416587, 0xbf65863c, 0x2c704f9e, 0x348e3d17, 0xc0b4c2d1, 0x74b8fb2, 0x24a43ea, 0xa2ceff1d, 0x2695cb72, 0x71a563e5};
	uint32_t modulusA[32] = {0xcc70b25c, 0xd644e756, 0x8336c7fe, 0xe148d14c, 0x2839d46b, 0x9bf690b4, 0x6b2073d2, 0xa181a113, 0x6ebbc420, 0x34d52f5c, 0xe0c55f6c, 0xf6aed990, 0xf1a68b1a, 0xa1b5db9f, 0x1f2a235, 0xa11c0ba0, 0x229664b8, 0x9f0272df, 0x82998679, 0x9f7c64a2, 0x90de6e7d, 0xb47d6fff, 0xe99586da, 0xe9609f47, 0xd749a8dc, 0x642692b6, 0x47f0938, 0x8d221c03, 0xfb482658, 0x2c22945d, 0x5070919f, 0x3065b46f};
	uint32_t publicExponentA[1] = {0x10001};
	uint32_t privateExponentA[32] = { 0x7af42061, 0x7340777d, 0x7166e5fb, 0x65947cc3, 0xf7c167fe, 0xdc0afb56, 0x76c34ac5, 0x57faf55c, 0x1191fdcf, 0x7cd6e628, 0x4eca85ac, 0xabe3d6d7, 0xb46dfc65, 0x24f291c6, 0x6e60be79, 0x708ec472, 0x13e2f4a6, 0xb5109716, 0x4b5ad5c3, 0xfeefd2eb, 0xdde552bd, 0x2edf499c, 0x41ac15f2, 0xc879c0c1, 0xcaad1c4e, 0xae82c05d, 0xd3e86909, 0xbe6df0e, 0x81beeb96, 0x64783820, 0xf62ab20c, 0x58187671};

	
	uint32_t result[32] = {0};
	uint32_t lambda[32] = {0};

	multiplication(prime1minus1, prime2minus1, lambda, 16, 16);
	modMult(publicExponentB, privateExponentB, lambda, result, 1, 32, 32);
	printArray32(result,"e*d mod lambda",32);
	
	return 1;
}